<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="bi bi-journal-text me-2"></i>Verification Logs</h2>
  </div>

  <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <i class="bi bi-exclamation-triangle-fill me-2"></i><%= error %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% } %>

  <!-- Filter Card -->
  <!-- ... Code remains unchanged for filtering ... -->

  <!-- Logs Table -->
  <!-- ... Code remains unchanged for displaying logs and pagination ... -->

  <!-- Analytics Card -->
  <div class="card mt-4">
    <div class="card-header bg-white">
      <h5 class="mb-0"><i class="bi bi-graph-up me-2"></i>Verification Analytics</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <div class="card mb-3">
            <div class="card-body">
              <h6 class="card-title">Verification Success Rate</h6>
              <% const totalLogs = logs?.length || 0;
                 const validLogs = logs?.filter(l => l.isValid).length || 0;
                 const invalidLogs = totalLogs - validLogs;
                 const successRate = totalLogs > 0 ? Math.round((validLogs / totalLogs) * 100) : 0; %>
              <div class="progress" style="height: 25px;">
                <div class="progress-bar bg-success" role="progressbar" style="width:<%= successRate %>%" aria-valuenow="<%= successRate %>" aria-valuemin="0" aria-valuemax="100">
                  <%= successRate %>%
                </div>
              </div>
              <div class="d-flex justify-content-between mt-2">
                <small class="text-muted">Invalid: <%= invalidLogs %></small>
                <small class="text-muted">Valid: <%= validLogs %></small>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-6">
          <div class="card mb-3">
            <div class="card-body">
              <h6 class="card-title">Top Verification Sources</h6>
              <ul class="list-group list-group-flush">
                <% 
                  const ipCounts = {};
                  if (logs && logs.length > 0) {
                    logs.forEach(log => {
                      if (log.ipAddress) {
                        ipCounts[log.ipAddress] = (ipCounts[log.ipAddress] || 0) + 1;
                      }
                    });
                  }
                  const topIPs = Object.entries(ipCounts).sort((a, b) => b[1] - a[1]).slice(0, 5);
                %>
                <% if (topIPs.length > 0) { %>
                  <% topIPs.forEach(([ip, count]) => { %>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                      <%= ip %>
                      <span class="badge bg-primary rounded-pill"><%= count %></span>
                    </li>
                  <% }) %>
                <% } else { %>
                  <li class="list-group-item text-center">No data available</li>
                <% } %>
              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
